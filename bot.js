const{Client,GatewayIntentBits,SlashCommandBuilder}=require('discord.js'),config=require('./config.json'),{createCanvas,loadImage}=require('canvas');const client=new Client({intents:[GatewayIntentBits.Guilds,GatewayIntentBits.GuildMessages],allowedMentions:{parse:['users','roles']}}),startupMessage='This bot is created by: Will3m026';console.log(startupMessage);client.once('ready',()=>{console.log('Bot is ready');registerSlashCommands();});client.on('interactionCreate',async interaction=>{if(!interaction.isCommand())return;if(!interaction.member.roles.cache.some(role=>config.allowedRoles.includes(role.id))){return interaction.reply('You do not have permission to use this command.');}const command=interaction.commandName;if(command===config.commandName){const title=interaction.options.getString('title'),description=interaction.options.getString('description')||'No description provided',color=interaction.options.getString('color')||config.defaultColor,imageChoice=interaction.options.getInteger('image'),channel=client.channels.cache.get(config.channelId);if(!channel)return interaction.reply('Channel not found');try{const imageURL=config.templateImages[imageChoice-1];if(!imageURL)return interaction.reply('Invalid image choice.');const canvas=createCanvas(1500,500),ctx=canvas.getContext('2d');const backgroundImage=await loadImage(imageURL);ctx.drawImage(backgroundImage,0,0,canvas.width,canvas.height);ctx.font='bold 72px Arial';ctx.fillStyle='white';ctx.textAlign='center';ctx.fillText(title,canvas.width/2,120);ctx.beginPath();ctx.moveTo(200,180);ctx.lineTo(1300,180);ctx.strokeStyle='white';ctx.lineWidth=3;ctx.stroke();ctx.closePath();ctx.font='bold 36px Arial';ctx.fillText(description,canvas.width/2,250);await channel.send({files:[canvas.toBuffer()]});interaction.reply('Message sent successfully.');}catch(error){console.error('Error sending message:',error);interaction.reply('An error occurred while sending the message.');}}});async function registerSlashCommands(){try{await client.guilds.cache.get(config.guildId)?.commands.set([new SlashCommandBuilder().setName(config.commandName).setDescription('Send a message').addIntegerOption(option=>option.setName('image').setDescription('Choose an image (1, 2, 3)').setRequired(!0)).addStringOption(option=>option.setName('title').setDescription('Title of the message').setRequired(!0)).addStringOption(option=>option.setName('description').setDescription('Description of the message')).addStringOption(option=>option.setName('color').setDescription('Color of the message'))]);console.log('Slash commands registered successfully.');}catch(error){console.error('Error registering slash commands:',error);}}client.login(config.token);
